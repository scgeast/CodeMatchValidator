saat file di  upload langsung proses file otomatis...tanpa klik tombol proses  file.
hilangkan tombol proses file..

hilangkan text "Upload file Excel (.xls, .xlsx). Aplikasi akan memvalidasi apakah huruf ke-3 dari kanan pada Product Code cocok dengan jarak."
agar header bisa lebih naik.

dan hilangkan text " Ringkasan per Site: Menampilkan data unik berdasarkan Site No & Site Name"
agar tampilan  tabel pada tab detail dan summary sama 
pada   judul aplikasi 



<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>CodeMatch Validator</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: Arial, sans-serif;
      background-color: #f5f5f5;
      height: 100vh;
      overflow: hidden;
    }

    .container {
      height: 100vh;
      display: flex;
      flex-direction: column;
      padding: 0;
      overflow-y: auto;
    }

    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 25px;
      background-color: #8B0000;
      color: white;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .header h1 {
      color: white;
      font-size: 1.8rem;
      margin: 0;
      letter-spacing: 0.5px;
    }

    .header p {
      color: rgba(255, 255, 255, 0.9);
      font-size: 0.8rem;
      margin-top: 3px;
    }

    .title-section {
      display: flex;
      flex-direction: column;
    }

    .upload-section {
      display: flex;
      align-items: center;
    }

    #fileInput {
      padding: 5px 10px;
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 4px;
      background-color: rgba(255, 255, 255, 0.1);
      color: white;
      font-size: 12px;
      cursor: pointer;
      transition: all 0.2s ease;
      width: 200px;
    }

    #fileInput:hover {
      background-color: rgba(255, 255, 255, 0.2);
      border-color: rgba(255, 255, 255, 0.5);
    }

    #fileInput::-webkit-file-upload-button {
      background-color: white;
      color: #8B0000;
      padding: 4px 12px;
      border: none;
      border-radius: 3px;
      font-weight: 600;
      font-size: 12px;
      margin-right: 8px;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    #fileInput::-webkit-file-upload-button:hover {
      background-color: #f8f8f8;
      transform: scale(1.02);
    }

    .main-content {
      padding: 20px;
      flex-grow: 1;
    }

    .download-btn {
      margin-top: 15px;
      background-color: #28a745;
      color: white;
      padding: 8px 16px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-weight: 600;
      font-size: 14px;
      transition: all 0.3s ease;
    }

    .download-btn:hover {
      background-color: #218838;
      transform: scale(1.02);
    }

    .controls {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
      flex-wrap: wrap;
      gap: 10px;
    }

    .filter-status {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .filter-status label {
      font-weight: 600;
      color: #333;
      font-size: 14px;
    }

    .filter-status select {
      padding: 6px 10px;
      border: 1px solid #ddd;
      border-radius: 4px;
      background-color: white;
      font-size: 13px;
    }

    .toggle-cols {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }

    .toggle-cols button {
      padding: 6px 12px;
      background-color: #6c757d;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 13px;
      transition: all 0.3s ease;
    }

    .toggle-cols button:hover {
      background-color: #5a6268;
    }

    .hidden {
      display: none !important;
    }

    #loadingIndicator {
      text-align: center;
      font-size: 16px;
      color: #8B0000;
      margin: 20px 0;
      font-weight: bold;
    }

    /* Tab Styles */
    .tabs {
      display: flex;
      gap: 8px;
      margin-bottom: 15px;
      border-bottom: 2px solid #ddd;
      padding-bottom: 8px;
    }

    .tab-btn {
      background-color: #f0f0f0;
      color: #333;
      border: none;
      padding: 8px 16px;
      cursor: pointer;
      border-radius: 4px 4px 0 0;
      font-size: 14px;
      font-weight: 600;
      transition: all 0.3s ease;
    }

    .tab-btn.active {
      background-color: #8B0000;
      color: white;
    }

    .tab-btn:hover:not(.active) {
      background-color: #e0e0e0;
    }

    .tab-content {
      display: none;
    }

    .tab-content.active {
      display: block;
    }

    .results-wrapper {
      flex-grow: 1;
      overflow-x: auto;
      overflow-y: auto;
      padding: 5px;
      background-color: white;
      border-radius: 6px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .results-wrapper h2 {
      color: #8B0000;
      margin-bottom: 12px;
      font-size: 1.3rem;
      padding-bottom: 8px;
      border-bottom: 2px solid #8B0000;
    }

    #resultsTable {
      width: 100%;
      border-collapse: collapse;
      table-layout: fixed;
    }

    #resultsTable th,
    #resultsTable td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: left;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      font-size: 13px;
    }

    #resultsTable th {
      background-color: #f8f9fa;
      color: #333;
      font-weight: 600;
      position: sticky;
      top: 0;
      z-index: 10;
      font-size: 13px;
    }

    /* Summary Table - Custom Column Widths */
    #summaryTable {
      width: 100%;
      border-collapse: collapse;
      table-layout: fixed;
    }

    #summaryTable th,
    #summaryTable td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: left;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      font-size: 13px;
    }

    #summaryTable th {
      background-color: #f8f9fa;
      color: #333;
      font-weight: 600;
      position: sticky;
      top: 0;
      z-index: 10;
      font-size: 13px;
    }

    /* Custom column widths for Summary Table */
    #summaryTable th:nth-child(1) { width: 5%; }   /* No */
    #summaryTable th:nth-child(2) { width: 12%; }  /* Plant Name */
    #summaryTable th:nth-child(3) { width: 8%; }   /* Site No */
    #summaryTable th:nth-child(4) { width: 15%; }  /* Site Name */
    #summaryTable th:nth-child(5) { width: 12%; }  /* Product Code */
    #summaryTable th:nth-child(6) { width: 8%; }   /* Distance */
    #summaryTable th:nth-child(7) { width: 12%; }  /* Standard Range */
    #summaryTable th:nth-child(8) { width: 12%; }  /* Expected Code */
    #summaryTable th:nth-child(9) { width: 8%; }   /* Status */

    .error {
      color: #8B0000;
      text-align: center;
      margin-top: 20px;
      padding: 12px;
      background-color: #ffe6e6;
      border-radius: 4px;
      font-weight: bold;
      font-size: 14px;
    }

    /* Date formatting */
    .date-cell {
      white-space: nowrap;
    }
  </style>
</head>
<body>

  <div class="container">
    <div class="header">
      <div class="title-section">
        <h1>CodeMatch Validator</h1>
        <p>Product Code & Distance Validation Tool</p>
      </div>
      <div class="upload-section">
        <input type="file" id="fileInput" accept=".xls,.xlsx" />
      </div>
    </div>

    <div class="main-content">
      <div id="loadingIndicator" class="hidden">Processing...</div>

      <div id="resultsContainer" class="hidden">
        <div class="tabs">
          <button id="tabDetailBtn" class="tab-btn active">Detail</button>
          <button id="tabSummaryBtn" class="tab-btn">Summary</button>
        </div>

        <div id="detailTab" class="tab-content active">
          <div class="controls">
            <div class="filter-status">
              <label for="statusFilter">Filter Status:</label>
              <select id="statusFilter">
                <option value="">All</option>
                <option value="Valid">Valid</option>
                <option value="Invalid">Invalid</option>
              </select>
            </div>
            <div class="toggle-cols">
              <button id="toggleRangeBtn">Hide Standard Range</button>
              <button id="toggleKodeBtn">Hide Expected Code</button>
            </div>
          </div>

          <div class="results-wrapper">
            <h2>Detailed Validation Results</h2>
            <table id="resultsTable">
              <thead>
                <tr>
                  <th>DP No</th>
                  <th>DP Date</th>
                  <th>Plant Name</th>
                  <th>Site No</th>
                  <th>Site Name</th>
                  <th>Product Code</th>
                  <th>Distance</th>
                  <th>Extracted Code</th>
                  <th id="rangeTh">Standard Range</th>
                  <th id="kodeTh">Expected Code</th>
                  <th>Status</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </div>

        <div id="summaryTab" class="tab-content">
          <div class="controls">
            <div class="filter-status">
              <label for="summaryStatusFilter">Filter Status:</label>
              <select id="summaryStatusFilter">
                <option value="">All</option>
                <option value="Valid">Valid</option>
                <option value="Invalid">Invalid</option>
              </select>
            </div>
          </div>
          
          <div class="results-wrapper">
            <h2>Summary per Site</h2>
            <table id="summaryTable">
              <thead>
                <tr>
                  <th>No</th>
                  <th>Plant Name</th>
                  <th>Site No</th>
                  <th>Site Name</th>
                  <th>Product Code</th>
                  <th>Distance</th>
                  <th>Standard Range</th>
                  <th>Expected Code</th>
                  <th>Status</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </div>

        <button id="downloadBtn" class="download-btn hidden">Download Results</button>
      </div>

      <div id="errorOutput" class="error hidden"></div>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const fileInput = document.getElementById("fileInput");
      const resultsContainer = document.getElementById("resultsContainer");
      const resultsTable = document.getElementById("resultsTable").getElementsByTagName("tbody")[0];
      const summaryTable = document.getElementById("summaryTable").getElementsByTagName("tbody")[0];
      const downloadBtn = document.getElementById("downloadBtn");
      const loadingIndicator = document.getElementById("loadingIndicator");
      const errorOutput = document.getElementById("errorOutput");
      
      const statusFilter = document.getElementById("statusFilter");
      const summaryStatusFilter = document.getElementById("summaryStatusFilter");
      
      const toggleRangeBtn = document.getElementById("toggleRangeBtn");
      const toggleKodeBtn = document.getElementById("toggleKodeBtn");
      const rangeTh = document.getElementById("rangeTh");
      const kodeTh = document.getElementById("kodeTh");
      
      const tabDetailBtn = document.getElementById("tabDetailBtn");
      const tabSummaryBtn = document.getElementById("tabSummaryBtn");
      const detailTab = document.getElementById("detailTab");
      const summaryTab = document.getElementById("summaryTab");

      let originalData = [];
      let summaryData = [];

      const CODE_DISTANCE_MAP = {
        'A': [0, 15],
        'B': [16, 25],
        'C': [26, 30],
        'D': [31, 35],
        'E': [36, 40],
        'F': [41, 45],
        'G': [46, 50],
        'H': [51, 55],
        'I': [56, 60],
        'J': [61, 65],
        'K': [66, 70],
        'L': [71, 75],
      };

      function getExpectedCode(distance) {
        for (let code in CODE_DISTANCE_MAP) {
          const [min, max] = CODE_DISTANCE_MAP[code];
          if (distance >= min && distance <= max) {
            return code;
          }
        }
        return null;
      }

      function getStandardRange(code) {
        if (code in CODE_DISTANCE_MAP) {
          return `${CODE_DISTANCE_MAP[code][0]}-${CODE_DISTANCE_MAP[code][1]}`;
        }
        return "Unknown";
      }

      function formatDate(dateValue) {
        if (!dateValue) return '';
        
        // If it's a number (Excel serial date)
        if (typeof dateValue === 'number') {
          try {
            // Convert Excel serial date to JavaScript date
            const date = XLSX.SSF.parse_date_code(dateValue);
            if (date) {
              const day = String(date.d).padStart(2, '0');
              const month = String(date.m).padStart(2, '0');
              const year = date.y;
              return `${day}/${month}/${year}`;
            }
          } catch (e) {
            console.log('Error parsing Excel date:', e);
          }
        }
        
        // If it's a string, try to parse and format
        if (typeof dateValue === 'string') {
          // Remove any time part if exists
          const datePart = dateValue.split(' ')[0];
          
          // Try different date formats
          const patterns = [
            { regex: /^(\d{4})-(\d{2})-(\d{2})$/, format: (y,m,d) => `${d}/${m}/${y}` }, // YYYY-MM-DD
            { regex: /^(\d{2})\/(\d{2})\/(\d{4})$/, format: (d,m,y) => `${d}/${m}/${y}` }, // DD/MM/YYYY
            { regex: /^(\d{2})-(\d{2})-(\d{4})$/, format: (d,m,y) => `${d}/${m}/${y}` }, // DD-MM-YYYY
            { regex: /^(\d{1,2})\/(\d{1,2})\/(\d{4})$/, format: (d,m,y) => `${d.padStart(2,'0')}/${m.padStart(2,'0')}/${y}` } // D/M/YYYY
          ];
          
          for (let pattern of patterns) {
            const match = datePart.match(pattern.regex);
            if (match) {
              return pattern.format(match[1], match[2], match[3]);
            }
          }
        }
        
        // Return original value if can't format
        return dateValue || '';
      }

      function renderTable(data) {
        resultsTable.innerHTML = '';
        data.forEach((row) => {
          const tr = resultsTable.insertRow();
          tr.insertCell().textContent = row['DP No'] || '';
          tr.insertCell().textContent = row['DP Date'] || '';
          tr.insertCell().textContent = row['Plant Name'] || '';
          tr.insertCell().textContent = row['Site No'] || '';
          tr.insertCell().textContent = row['Site Name'] || '';
          tr.insertCell().textContent = row['Product Code'] || '';
          tr.insertCell().textContent = row['Distance'] || '';
          tr.insertCell().textContent = row['Extracted Code'] || 'N/A';
          tr.insertCell().textContent = row['Standard Range'] || 'N/A';
          tr.insertCell().textContent = row['Expected Code'] || 'N/A';
          tr.insertCell().textContent = row['Status'];

          if (row['Status'] === "Invalid") {
            tr.style.backgroundColor = "#ffebee";
          }
        });
      }

      function generateSummaryData(data) {
        const uniqueSites = new Map();
        
        data.forEach((row) => {
          const siteKey = `${row['Site No']}|${row['Site Name']}`;
          if (!uniqueSites.has(siteKey)) {
            uniqueSites.set(siteKey, {
              'Plant Name': row['Plant Name'],
              'Site No': row['Site No'],
              'Site Name': row['Site Name'],
              'Product Code': row['Product Code'],
              'Distance': row['Distance'],
              'Standard Range': row['Standard Range'],
              'Expected Code': row['Expected Code'],
              'Status': row['Status']
            });
          }
        });

        return Array.from(uniqueSites.values());
      }

      function renderSummary(data) {
        summaryData = generateSummaryData(data);
        renderFilteredSummary(summaryStatusFilter.value);
      }

      function renderFilteredSummary(status) {
        summaryTable.innerHTML = '';
        
        let filteredData = summaryData;
        if (status) {
          filteredData = summaryData.filter(row => row.Status === status);
        }
        
        filteredData.forEach((row, index) => {
          const tr = summaryTable.insertRow();
          tr.insertCell().textContent = index + 1;
          tr.insertCell().textContent = row['Plant Name'] || '';
          tr.insertCell().textContent = row['Site No'] || '';
          tr.insertCell().textContent = row['Site Name'] || '';
          tr.insertCell().textContent = row['Product Code'] || '';
          tr.insertCell().textContent = row['Distance'] || '';
          tr.insertCell().textContent = row['Standard Range'] || 'N/A';
          tr.insertCell().textContent = row['Expected Code'] || 'N/A';
          tr.insertCell().textContent = row['Status'];

          if (row['Status'] === "Invalid") {
            tr.style.backgroundColor = "#ffebee";
          }
        });
      }

      function processFile(file) {
        if (!file) {
          showError("Please select a file first.");
          return;
        }

        hideError();
        loadingIndicator.classList.remove("hidden");

        const reader = new FileReader();
        reader.onload = (e) => {
          setTimeout(() => {
            try {
              const data = new Uint8Array(e.target.result);
              const workbook = XLSX.read(data, { type: 'array' });
              const firstSheetName = workbook.SheetNames[0];
              const worksheet = workbook.Sheets[firstSheetName];
              let jsonData = XLSX.utils.sheet_to_json(worksheet, { 
                header: 1,
                defval: '',
                blankrows: false
              });

              // Get headers from first row
              const headers = jsonData[0];
              const rows = jsonData.slice(1);

              // Process data
              originalData = [];
              rows.forEach((row) => {
                if (row.length === 0) return;
                
                const rowData = {};
                headers.forEach((header, index) => {
                  rowData[header] = row[index] || '';
                });

                const productCode = rowData['Product Code'] || rowData['Product Code'.toUpperCase()] || rowData['product code'] || rowData['PRODUCT CODE'] || '';
                let distanceStr = rowData['Distance'] || rowData['Distance (KM)'] || rowData['DISTANCE'] || rowData['distance'] || '';
                
                // Format DP Date
                let dpDate = rowData['DP No'] ? rowData['DP Date'] || rowData['dp date'] || rowData['DP DATE'] || '' : '';
                dpDate = formatDate(dpDate);

                // Extract 3rd character from the right
                let extractedCode = null;
                if (typeof productCode === 'string' && productCode.length >= 3) {
                  extractedCode = productCode.slice(-3, -2);
                  if (!/[A-Z]/i.test(extractedCode)) {
                    extractedCode = null;
                  }
                }

                // Parse distance
                let distanceNum = null;
                if (typeof distanceStr === 'number') {
                  distanceNum = distanceStr;
                } else if (typeof distanceStr === 'string') {
                  const numMatch = distanceStr.match(/\d+(\.\d+)?/);
                  if (numMatch) {
                    distanceNum = parseFloat(numMatch[0]);
                  }
                }

                const expectedCode = getExpectedCode(distanceNum);
                const standardRange = extractedCode ? getStandardRange(extractedCode) : "N/A";
                const status = (extractedCode && extractedCode === expectedCode) ? "Valid" : "Invalid";

                originalData.push({
                  'DP No': rowData['DP No'] || rowData['DP NO'] || rowData['dp no'] || '',
                  'DP Date': dpDate,
                  'Plant Name': rowData['Plant Name'] || rowData['plant name'] || '',
                  'Site No': rowData['Site No'] || rowData['site no'] || '',
                  'Site Name': rowData['Site Name'] || rowData['site name'] || '',
                  'Product Code': productCode || '',
                  'Distance': distanceStr || '',
                  'Extracted Code': extractedCode || 'N/A',
                  'Standard Range': standardRange,
                  'Expected Code': expectedCode || 'N/A',
                  'Status': status
                });
              });

              window.jsonData = originalData;

              renderTable(originalData);
              renderSummary(originalData);

              resultsContainer.classList.remove("hidden");
              downloadBtn.classList.remove("hidden");
              loadingIndicator.classList.add("hidden");
              errorOutput.classList.add("hidden");

            } catch (err) {
              showError("Failed to read file. Please check the file format.");
              console.error(err);
              loadingIndicator.classList.add("hidden");
            }
          }, 500);
        };
        reader.readAsArrayBuffer(file);
      }

      fileInput.addEventListener("change", (e) => {
        const file = e.target.files[0];
        if (file) {
          processFile(file);
        }
      });

      tabDetailBtn.addEventListener("click", () => {
        tabDetailBtn.classList.add("active");
        tabSummaryBtn.classList.remove("active");
        detailTab.classList.add("active");
        summaryTab.classList.remove("active");
      });

      tabSummaryBtn.addEventListener("click", () => {
        tabSummaryBtn.classList.add("active");
        tabDetailBtn.classList.remove("active");
        summaryTab.classList.add("active");
        detailTab.classList.remove("active");
      });

      statusFilter.addEventListener("change", () => {
        const selectedStatus = statusFilter.value;
        if (selectedStatus === "") {
          renderTable(originalData);
        } else {
          const filteredData = originalData.filter(row => row.Status === selectedStatus);
          renderTable(filteredData);
        }
      });

      summaryStatusFilter.addEventListener("change", () => {
        const selectedStatus = summaryStatusFilter.value;
        renderFilteredSummary(selectedStatus);
      });

      let rangeVisible = true;
      toggleRangeBtn.addEventListener("click", () => {
        const cells = document.querySelectorAll(`#resultsTable td:nth-child(9)`);
        const th = document.querySelector("#rangeTh");
        if (rangeVisible) {
          cells.forEach(cell => cell.classList.add("hidden"));
          th.classList.add("hidden");
          toggleRangeBtn.textContent = "Show Standard Range";
          rangeVisible = false;
        } else {
          cells.forEach(cell => cell.classList.remove("hidden"));
          th.classList.remove("hidden");
          toggleRangeBtn.textContent = "Hide Standard Range";
          rangeVisible = true;
        }
      });

      let kodeVisible = true;
      toggleKodeBtn.addEventListener("click", () => {
        const cells = document.querySelectorAll(`#resultsTable td:nth-child(10)`);
        const th = document.querySelector("#kodeTh");
        if (kodeVisible) {
          cells.forEach(cell => cell.classList.add("hidden"));
          th.classList.add("hidden");
          toggleKodeBtn.textContent = "Show Expected Code";
          kodeVisible = false;
        } else {
          cells.forEach(cell => cell.classList.remove("hidden"));
          th.classList.remove("hidden");
          toggleKodeBtn.textContent = "Hide Expected Code";
          kodeVisible = true;
        }
      });

      downloadBtn.addEventListener("click", () => {
        const wb = XLSX.utils.book_new();
        
        const wsDetail = XLSX.utils.json_to_sheet(originalData);
        XLSX.utils.book_append_sheet(wb, wsDetail, "Validation Details");
        
        const summaryData = generateSummaryData(originalData);
        const wsSummary = XLSX.utils.json_to_sheet(summaryData);
        XLSX.utils.book_append_sheet(wb, wsSummary, "Site Summary");
        
        XLSX.writeFile(wb, "codematch_validation_results.xlsx");
      });

      function showError(msg) {
        errorOutput.textContent = msg;
        errorOutput.classList.remove("hidden");
      }

      function hideError() {
        errorOutput.classList.add("hidden");
      }
    });
  </script>
</body>
</html>
